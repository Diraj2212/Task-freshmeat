<form class="container" [formGroup]="purchaseOrderForm" (ngSubmit)="saveorder()">
    <div class="card" style="width: 1200px">
        <h3>Purchase Order</h3>

        <div class="card-body">

            <div class="row">
                <div class="col-lg-6">
                    <div class="form-group">
                        Date :  {{todaysdate | date: 'dd/M/yyyy'}}
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="form-group">
                        <mat-form-field>
                            <mat-select placeholder="Select  the Store"  name="storeId" (selectionChange)="diplayCategoryTypeonchange()" formControlName="wareHouseId" >                      <mat-option>None</mat-option>
                                <mat-option *ngFor="let store of stores" [value]="store.storeId">{{store.storeName}}
                                </mat-option>
                            </mat-select>
                        </mat-form-field>
                    </div>
                </div>           
              
            </div>
            <br>

            <div class="row">
                <div class="col-lg-12">
                    <table  class="table table-bordered" formArrayName="details">

                        <thead >
                            <tr>
                        <td style="width: 5%">Sl.No</td>
                        <td style="width: 10%">Category Type</td>
                        <td style="width: 10%">Category Name</td>
                        <td style="width: 10%">Sub Category</td>
                        <td style="width: 10%">Product</td>
                        
                        <td style="width: 10%">Quantity(No.of Packs)</td>
                        <td style="width: 10%">Price/Pack</td>
                        <td style="width: 5%">Discount</td>
                        <td style="width: 10%">Total</td>
                        <td>Action</td> 
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let item of products.controls;let i=index" [formGroupName]="i">
                                <td>{{i+1}}</td>
                                <td>
                                    <mat-select class="form-control"  (selectionChange) = "getCategoryforStore(i)" formControlName="catergoryType" >
                                        <mat-option *ngFor="let item of categoryTypes" [value]="item.categoryTypeId">
                                            {{item.categoryTypeName}}
                                        </mat-option>
                                    </mat-select>
        
                                </td>
                                <td>
                                    <mat-select class="form-control" (selectionChange)="getSubcategoryforStore(i)" formControlName="category">
                                        <mat-option *ngFor="let item of category" [value]="item.categoryId">
                                            {{item.categoryName}}
                                        </mat-option>
                                    </mat-select>
        
                                </td>
                                <td>
                                    <mat-select class="form-control" formControlName="subCategory"  (selectionChange)="getProductforStore(i)">
                                        <mat-option *ngFor="let item of subcategory" [value]="item.subCategoryId">
                                            {{item.subCategoryName}}
                                        </mat-option>
                                    </mat-select>
        
                                </td>
                                <td>
                                    <mat-select class="form-control" formControlName="productId" (selectionChange)="getProductPrice(i)" >
                                        <mat-option *ngFor="let item of product" [value]="item.productId">
                                            {{item.productName}}
                                        </mat-option>
                                    </mat-select>
                                    
        
                                </td>
                                 <td>
                                    <input class="form-control" formControlName="quantityNumber" (change)="getTotalPrice(i)">
        
                                </td>
                                <td>
                                    <input class="form-control" matInput  name ="packPrice" formControlName="packPrice" (selectionChange)="getProductPrice(i)">
                                    <!-- <mat-select class="form-control" formControlName="packPrice"  >
                                        <mat-option *ngFor="let item of productdetails" [value]="item.unitPrice">
                                            {{item.unitPrice}}
                                        </mat-option>
                                    </mat-select> -->
                                
        
                                </td>
                                <td>
                                    <input class="form-control" matInput  name ="discountPercentage" formControlName="discountPercentage" (selectionChange)="getTotalPrice(i)">
                                    
                                    <!-- <mat-select class="form-control" formControlName="discountPercentage"  (selectionChange)="getTotalPrice(i)">
                                        <mat-option *ngFor="let item of productdetails" [value]="item.discountPercentage">
                                            {{item.discountPercentage}}
                                        </mat-option>
                                    </mat-select> -->
        
                                </td>
                                <td>
                                    <input class="form-control" formControlName="totalPrice"/>
        
                                </td>
                                <td>
                                    <button mat-icon-button color="warn" (click)="deleteProduct(i)">
                                        <mat-icon>delete</mat-icon>
                                    </button>
        
                                </td>

                            </tr>
                        </tbody>
                        <tfoot>
                            <tr>
                                <td colspan="6">
                                    <a (click)="addNewProduct()" class="btn btn-success">[+]</a>
                                </td>
                            </tr>
                        </tfoot>

                    </table>
                </div>

            </div>
            <br>
            <div class="row">                
                <div class="col-lg-4">
                    <div class="form-group">
                        <label>Summary NetTotal</label>
                        <input formControlName="netPrice" class="form-control">
                    </div>
                </div>
                <div class="col-lg-12">
                    <br>
                    <button class="btn btn-success" type="submit">Save</button> | 
                    <a class="btn btn-danger" >Back</a>
                </div>

            </div>

        </div>

    </div>
</form>